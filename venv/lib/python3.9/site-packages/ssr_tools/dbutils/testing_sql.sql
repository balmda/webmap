SELECT b.attname
FROM pg_index a
    JOIN pg_attribute b
        ON b.attrelid = a.indrelid
        AND b.attnum = ANY(a.indkey)
WHERE a.indrelid = 'p010.received_spd_crashes_contextualized'::REGCLASS
AND a.indisprimary
;

SELECT               
  pg_attribute.attname, 
  format_type(pg_attribute.atttypid, pg_attribute.atttypmod) 
FROM pg_index, pg_class, pg_attribute, pg_namespace 
WHERE 
  pg_class.oid = p010.received_intersections::regclass AND 
  indrelid = pg_class.oid AND 
  nspname = 'public' AND 
  pg_class.relnamespace = pg_namespace.oid AND 
  pg_attribute.attrelid = pg_class.oid AND 
  pg_attribute.attnum = any(pg_index.indkey)
 AND indisprimary

SELECT a.attname, format_type(a.atttypid, a.atttypmod) AS data_type
FROM   pg_index i
JOIN   pg_attribute a ON a.attrelid = i.indrelid
                     AND a.attnum = ANY(i.indkey)
WHERE  i.indrelid = 'p010.received_spd_crashes_contextualized'::regclass
AND    i.indisprimary;


SELECT find_srid('p010','received_spd_crashes_contextualized','geom')

ALTER TABLE p010.received_segments ADD PRIMARY KEY (id);

SELECT 
    CEILING(MAX(_length / 528))::INT + 1 
FROM p010.dissolved_network
;

SELECT DISTINCT severitydesc
FROM p010.received_spd_crashes_contextualized
