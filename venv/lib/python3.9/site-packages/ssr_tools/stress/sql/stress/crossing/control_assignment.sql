-- #2nd called;
DROP TABLE IF EXISTS scratch.tmp_control;
SELECT DISTINCT ON (tmp_combineddirs.id)
    tmp_combineddirs.id,
    control.{control_column} AS control, 
    tmp_combineddirs.{point}
INTO TABLE scratch.tmp_control
FROM
    scratch.tmp_combineddirs tmp_combineddirs,
    {control_schema}.{control_table} AS control
WHERE
    ST_DWithin(tmp_combineddirs.{point},control.{control_geom},{intersection_tolerance})
ORDER BY
    tmp_combineddirs.id,
    ST_Distance(tmp_combineddirs.{point},control.{control_geom}) ASC
;

-- SELECT * 
-- FROM scratch.tmp_control
-- WHERE id = 159233
-- ;
 