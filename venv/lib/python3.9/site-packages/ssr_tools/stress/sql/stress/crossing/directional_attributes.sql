-- just dumping everything into a single table

-- two way
INSERT INTO scratch.tmp_alldirs(
    id,
    lanes,
    speed, 
    aadt, 
    oneway)
SELECT
    {id_column}::INTEGER AS id,
    COALESCE({lanes},{assumed_lanes})::INTEGER,
    COALESCE({speed},{assumed_speed})::INTEGER, 
    COALESCE({aadt},{assumed_aadt})::INTEGER, 
    False AS oneway
FROM
    {in_schema}.{in_table}
WHERE
    {twoway}
;

-- one way
INSERT INTO scratch.tmp_alldirs(
    id,
    lanes,
    speed, 
    aadt, 
    oneway)
SELECT
    {id_column}::INTEGER,
    COALESCE({lanes},{assumed_lanes})::INTEGER,
    COALESCE({speed},{assumed_speed})::INTEGER, 
    COALESCE({aadt},{assumed_aadt})::INTEGER, 
    True AS oneway
FROM
    {in_schema}.{in_table}
WHERE
    {oneway}
;
 