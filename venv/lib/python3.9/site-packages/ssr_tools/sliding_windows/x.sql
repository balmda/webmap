DROP TABLE IF EXISTS p010.windows_crashes_tmp; 
CREATE TABLE p010.windows_crashes_tmp AS
SELECT * 
FROM p010.received_spd_crashes_contextualized
; 

ALTER TABLE p010.windows_crashes_tmp ADD PRIMARY KEY (inckey)
ALTER TABLE p010.windows_crashes_tmp ADD COLUMN IF NOT EXISTS mode_simple TEXT; 

UPDATE p010.windows_crashes_tmp 
SET mode_simple = CASE 
        WHEN crash_mode = 'Pedestrian' THEN 'ped'
        WHEN crash_mode = 'Bicycle' THEN 'bike'
        WHEN crash_mode = 'Bicycle-Pedestrian' THEN 'bike_ped'
        WHEN crash_mode = 'Bicycle-Bicycle' THEN 'bike_bike'
        WHEN crash_mode = 'Motorized Scooter' THEN 'scooter'
    ELSE 'unknown'
END;

SELECT DISTINCT crash_mode 
FROM p010.windows_crashes_tmp;
